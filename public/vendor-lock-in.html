<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Primary Meta Tags -->
  <title>Vendor Lock-In Score - Free Online Tool | The Shield IT</title>
  <meta name="title" content="Vendor Lock-In Score - Free Online Tool | The Shield IT">
  <meta name="description" content="Free vendor lock-in scoring tool. Evaluate your dependency on cloud providers, SaaS platforms, and technology vendors across 9 dimensions. Data stays in your browser.">
  <meta name="keywords" content="vendor lock-in, cloud dependency, technology risk assessment, SaaS lock-in, data portability, vendor independence, multi-cloud strategy, lock-in score">
  <meta name="author" content="Brandon Shields, The Shield IT">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://theshieldit.com/vendor-lock-in.html">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://theshieldit.com/vendor-lock-in.html">
  <meta property="og:title" content="Vendor Lock-In Score - Free Online Tool">
  <meta property="og:description" content="Score your vendor lock-in risk across 9 dimensions. Track services, export data, and plan your exit strategy.">
  <meta property="og:site_name" content="The Shield IT">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Vendor Lock-In Score - Free Online Tool">
  <meta name="twitter:description" content="Score your vendor lock-in risk across 9 dimensions. Track services, export data, and plan your exit strategy.">

  <script defer src="https://cloud.umami.is/script.js" data-website-id="f727bfa2-17ee-4141-82d3-a9b15d813fb6"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --secondary: #8b5cf6;
      --accent: #06b6d4;
      --bg-dark: #0f172a;
      --bg-darker: #020617;
      --text-light: #f1f5f9;
      --text-gray: #94a3b8;
      --border: #1e293b;
      --safe: #22c55e;
      --mild: #3b82f6;
      --caution: #eab308;
      --high: #f97316;
      --escape: #ef4444;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: var(--bg-darker);
      color: var(--text-light);
      line-height: 1.6;
      overflow-x: hidden;
    }

    .bg-animation {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; opacity: 0.4;
      background:
        radial-gradient(circle at 20% 50%, rgba(59,130,246,0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(139,92,246,0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(6,182,212,0.1) 0%, transparent 50%);
      animation: bgFloat 20s ease-in-out infinite;
    }

    @keyframes bgFloat {
      0%, 100% { transform: translate(0,0) scale(1); }
      33% { transform: translate(30px,-30px) scale(1.1); }
      66% { transform: translate(-20px,20px) scale(0.9); }
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 0 2rem;
      position: relative;
      z-index: 1;
      min-height: 100vh;
    }

    header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 2rem 0; animation: fadeInDown 0.8s ease-out;
    }

    .logo {
      display: flex; align-items: center; gap: 0.75rem;
      font-size: 1.25rem; font-weight: 700;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text; text-decoration: none;
    }

    .shield-icon {
      width: 36px; height: 36px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border-radius: 8px; display: flex; align-items: center; justify-content: center;
      box-shadow: 0 4px 12px rgba(59,130,246,0.3);
    }

    .back-link {
      display: flex; align-items: center; gap: 0.5rem;
      color: var(--text-gray); text-decoration: none; font-size: 0.95rem;
      transition: all 0.3s ease; padding: 0.5rem 1rem; border-radius: 8px;
    }
    .back-link:hover { color: var(--primary); background: rgba(59,130,246,0.1); }

    h1 {
      font-size: clamp(1.75rem, 4vw, 2.5rem); font-weight: 800; margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text; text-align: center; animation: fadeInUp 0.8s ease-out;
    }

    .subtitle {
      text-align: center; color: var(--text-gray); margin-bottom: 2rem;
      animation: fadeInUp 0.8s ease-out 0.1s both; font-style: italic;
    }

    .tool-layout { display: flex; flex-direction: column; gap: 2rem; animation: fadeInUp 0.8s ease-out 0.2s both; }

    .panel {
      background: rgba(30,41,59,0.5); border: 1px solid var(--border);
      border-radius: 16px; padding: 1.5rem; backdrop-filter: blur(10px);
    }

    .panel-title {
      font-size: 0.85rem; font-weight: 600; text-transform: uppercase;
      letter-spacing: 0.05em; color: var(--text-gray); margin-bottom: 1rem;
    }

    /* Form */
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem; }
    .form-group { margin-bottom: 0.75rem; }
    .form-group label { display: block; font-size: 0.8rem; font-weight: 500; color: var(--text-gray); margin-bottom: 0.3rem; }
    .form-group input, .form-group textarea {
      width: 100%; padding: 0.6rem 0.75rem; background: rgba(15,23,42,0.6);
      border: 1px solid var(--border); border-radius: 8px; color: var(--text-light);
      font-size: 0.9rem; font-family: inherit; outline: none; transition: border-color 0.2s ease;
    }
    .form-group input:focus, .form-group textarea:focus { border-color: var(--primary); }
    .form-group textarea { resize: vertical; min-height: 60px; }

    /* Sliders */
    .score-section { margin-bottom: 1rem; }
    .score-section-title {
      font-size: 0.85rem; font-weight: 600; margin-bottom: 0.75rem;
      display: flex; align-items: center; gap: 0.5rem;
    }
    .toggle-advanced {
      font-size: 0.75rem; color: var(--primary); cursor: pointer; background: none;
      border: 1px solid var(--primary); border-radius: 6px; padding: 0.2rem 0.6rem;
      font-family: inherit; transition: all 0.2s ease;
    }
    .toggle-advanced:hover { background: rgba(59,130,246,0.15); }

    .slider-group {
      display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.6rem;
      padding: 0.5rem 0.6rem; background: rgba(15,23,42,0.3); border-radius: 8px;
    }
    .slider-label {
      min-width: 110px; font-size: 0.8rem; color: var(--text-gray); display: flex;
      align-items: center; gap: 0.35rem;
    }
    .slider-label .tooltip-trigger {
      display: inline-flex; align-items: center; justify-content: center;
      width: 16px; height: 16px; border-radius: 50%; border: 1px solid var(--border);
      font-size: 0.65rem; color: var(--text-gray); cursor: help; position: relative;
    }
    .slider-label .tooltip-trigger:hover .tooltip-text {
      visibility: visible; opacity: 1;
    }
    .tooltip-text {
      visibility: hidden; opacity: 0; position: absolute; bottom: 130%; left: 50%;
      transform: translateX(-50%); background: var(--bg-dark); border: 1px solid var(--border);
      border-radius: 8px; padding: 0.5rem 0.75rem; font-size: 0.75rem; color: var(--text-light);
      width: 200px; z-index: 10; transition: opacity 0.2s ease; text-align: left;
      white-space: normal; font-weight: 400;
    }
    .slider-wrap { flex: 1; }
    input[type="range"] {
      -webkit-appearance: none; width: 100%; height: 6px; border-radius: 3px;
      background: var(--border); outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%;
      background: var(--primary); cursor: pointer; border: 2px solid var(--bg-darker);
    }
    input[type="range"]::-moz-range-thumb {
      width: 18px; height: 18px; border-radius: 50%;
      background: var(--primary); cursor: pointer; border: 2px solid var(--bg-darker);
    }
    .slider-value {
      min-width: 24px; text-align: center; font-size: 0.9rem; font-weight: 700;
      font-family: 'SFMono-Regular', Consolas, monospace;
    }

    /* Buttons */
    .btn-row { display: flex; gap: 0.75rem; margin-top: 1rem; }
    .btn {
      padding: 0.65rem 1.25rem; border: none; border-radius: 10px;
      font-size: 0.9rem; font-weight: 600; cursor: pointer; font-family: inherit;
      transition: all 0.3s ease;
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white; flex: 1;
    }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 8px 24px rgba(59,130,246,0.3); }
    .btn-secondary {
      background: transparent; border: 1px solid var(--border); color: var(--text-gray);
    }
    .btn-secondary:hover { border-color: var(--primary); color: var(--primary); }
    .btn-danger { background: rgba(239,68,68,0.15); border: 1px solid rgba(239,68,68,0.3); color: var(--escape); }
    .btn-danger:hover { background: rgba(239,68,68,0.25); }
    .btn-sm { padding: 0.4rem 0.75rem; font-size: 0.8rem; border-radius: 6px; }

    /* Toolbar */
    .toolbar { display: flex; gap: 0.75rem; margin-bottom: 1rem; flex-wrap: wrap; }
    .toolbar .search-input {
      flex: 1; min-width: 150px; padding: 0.5rem 0.75rem; background: rgba(15,23,42,0.6);
      border: 1px solid var(--border); border-radius: 8px; color: var(--text-light);
      font-size: 0.85rem; outline: none; font-family: inherit;
    }
    .toolbar .search-input:focus { border-color: var(--primary); }
    .toolbar select {
      padding: 0.5rem 0.75rem; background: rgba(15,23,42,0.6);
      border: 1px solid var(--border); border-radius: 8px; color: var(--text-light);
      font-size: 0.85rem; outline: none; font-family: inherit;
    }
    .toolbar select option { background: var(--bg-dark); }

    /* Table */
    .services-table { width: 100%; border-collapse: collapse; }
    .services-table th {
      text-align: left; padding: 0.6rem 0.75rem; font-size: 0.75rem; font-weight: 600;
      text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-gray);
      border-bottom: 1px solid var(--border);
    }
    .services-table td {
      padding: 0.6rem 0.75rem; font-size: 0.85rem;
      border-bottom: 1px solid rgba(30,41,59,0.5);
    }
    .services-table tr:hover td { background: rgba(59,130,246,0.04); }

    /* Score badge */
    .score-badge {
      display: inline-flex; align-items: center; gap: 0.4rem;
      padding: 0.2rem 0.6rem; border-radius: 6px; font-size: 0.8rem; font-weight: 600;
    }
    .score-badge--safe { background: rgba(34,197,94,0.15); color: var(--safe); }
    .score-badge--mild { background: rgba(59,130,246,0.15); color: var(--mild); }
    .score-badge--caution { background: rgba(234,179,8,0.15); color: var(--caution); }
    .score-badge--high { background: rgba(249,115,22,0.15); color: var(--high); }
    .score-badge--escape { background: rgba(239,68,68,0.15); color: var(--escape); }

    /* Detail view */
    .detail-view { display: none; }
    .detail-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
    .detail-meta { font-size: 0.8rem; color: var(--text-gray); margin-bottom: 1.5rem; }
    .detail-meta span { margin-right: 1.5rem; }
    .breakdown-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem; }
    .breakdown-item { padding: 0.6rem; background: rgba(15,23,42,0.4); border-radius: 8px; }
    .breakdown-label { font-size: 0.75rem; color: var(--text-gray); margin-bottom: 0.3rem; }
    .breakdown-bar { width: 100%; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; margin-bottom: 0.2rem; }
    .breakdown-fill { height: 100%; border-radius: 3px; transition: width 0.4s ease; }
    .breakdown-fill.safe { background: var(--safe); }
    .breakdown-fill.mild { background: var(--mild); }
    .breakdown-fill.caution { background: var(--caution); }
    .breakdown-fill.high { background: var(--high); }
    .breakdown-fill.escape { background: var(--escape); }
    .breakdown-value { font-size: 0.75rem; color: var(--text-gray); text-align: right; }

    .notes-display { white-space: pre-wrap; font-size: 0.85rem; color: var(--text-gray); background: rgba(15,23,42,0.4); border-radius: 8px; padding: 0.75rem; margin-top: 1rem; }

    /* Empty state */
    .empty-state { text-align: center; padding: 2rem; color: var(--text-gray); }
    .empty-state svg { display: block; margin: 0 auto 1rem; opacity: 0.3; }

    /* Privacy note */
    .privacy-note {
      display: flex; align-items: flex-start; gap: 0.5rem; margin-top: 1rem;
      padding: 0.75rem 1rem; background: rgba(6,182,212,0.08);
      border: 1px solid rgba(6,182,212,0.2); border-radius: 8px;
      font-size: 0.8rem; color: var(--text-gray); line-height: 1.5;
    }
    .privacy-note svg { flex-shrink: 0; margin-top: 1px; color: var(--accent); }

    /* Hidden file input */
    .hidden { display: none; }

    footer {
      text-align: center; padding: 2rem 0; margin-top: 3rem;
      border-top: 1px solid var(--border); color: var(--text-gray); font-size: 0.85rem;
    }

    @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

    @media (max-width: 768px) {
      .container { padding: 0 1rem; }
      header { flex-direction: column; gap: 1rem; align-items: flex-start; }
      .form-row { grid-template-columns: 1fr; }
      .slider-label { min-width: 90px; }
      .breakdown-grid { grid-template-columns: 1fr; }
      .services-table .hide-mobile { display: none; }
    }
  </style>
  <script src="/shared-shell.js" defer></script>
</head>
<body>
  <div class="bg-animation"></div>

  <div class="container">
    <header>
      <a href="/" class="logo">
        <div class="shield-icon">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>
        </div>
        The Shield IT
      </a>
      <a href="/" class="back-link">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
        All Tools
      </a>
    </header>

    <main>
      <h1>Vendor Lock-In Score</h1>
      <p class="subtitle">How trapped are you? Score your services and find out.</p>

      <div class="tool-layout">

        <!-- Add / Edit Form -->
        <div class="panel" id="formPanel">
          <div class="panel-title" id="formTitle">Add Service</div>

          <div class="form-row">
            <div class="form-group">
              <label for="serviceName">Service name</label>
              <input type="text" id="serviceName" placeholder="e.g. AWS, Google Workspace, Slack">
            </div>
            <div class="form-group">
              <label for="serviceCategory">Category</label>
              <input type="text" id="serviceCategory" placeholder="e.g. Cloud, SaaS, Database">
            </div>
          </div>

          <!-- Core Scores -->
          <div class="score-section">
            <div class="score-section-title">Core Dimensions</div>
            <div id="coreSliders"></div>
          </div>

          <!-- Advanced Scores -->
          <div class="score-section">
            <div class="score-section-title">
              Advanced Dimensions
              <button class="toggle-advanced" id="toggleAdvanced">Show</button>
            </div>
            <div id="advancedSliders" style="display:none;"></div>
          </div>

          <!-- Notes -->
          <div class="form-group">
            <label for="serviceNotes">Notes (optional)</label>
            <textarea id="serviceNotes" placeholder="Any notes about this service..."></textarea>
          </div>

          <div class="btn-row">
            <button class="btn btn-primary" id="saveBtn">Add Service</button>
            <button class="btn btn-secondary" id="cancelBtn" style="display:none;">Cancel</button>
          </div>

          <div class="privacy-note">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
            </svg>
            <span>All data is stored in your browser's localStorage. Nothing is sent to any server.</span>
          </div>
        </div>

        <!-- Services Table -->
        <div class="panel" id="tablePanel">
          <div class="panel-title">Your Services</div>

          <div class="toolbar">
            <input type="text" class="search-input" id="searchInput" placeholder="Search services...">
            <select id="sortSelect">
              <option value="score">Sort by Risk</option>
              <option value="name">Sort by Name</option>
              <option value="category">Sort by Category</option>
              <option value="date">Sort by Reviewed</option>
            </select>
            <button class="btn btn-secondary btn-sm" id="exportBtn">Export</button>
            <button class="btn btn-secondary btn-sm" id="importBtn">Import</button>
            <input type="file" id="importFile" accept=".json" class="hidden">
          </div>

          <div id="tableArea">
            <div class="empty-state" id="emptyState">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                <line x1="8" y1="21" x2="16" y2="21"></line>
                <line x1="12" y1="17" x2="12" y2="21"></line>
              </svg>
              Add a service above to get started
            </div>
          </div>
        </div>

        <!-- Detail View (hidden by default) -->
        <div class="panel detail-view" id="detailPanel">
          <div class="detail-header">
            <div>
              <div class="panel-title" id="detailTitle">Service Detail</div>
              <div class="detail-meta" id="detailMeta"></div>
            </div>
            <button class="btn btn-secondary btn-sm" id="detailBack">Back to List</button>
          </div>
          <div id="detailScore"></div>
          <div id="detailBreakdown"></div>
          <div id="detailNotes"></div>
          <div class="btn-row" style="margin-top: 1rem;">
            <button class="btn btn-secondary btn-sm" id="detailEdit">Edit</button>
            <button class="btn btn-danger btn-sm" id="detailDelete">Delete</button>
          </div>
        </div>

      </div>
    </main>

    <footer>
      <p>&copy; 2025 The Shield IT &middot; All data stays in your browser</p>
    </footer>
  </div>

  <script>
  (function() {
    /* ── Category definitions ── */
    var CORE_KEYS = ['export', 'format', 'identity', 'network'];
    var ADVANCED_KEYS = ['hardware', 'api', 'pricing', 'feature_gating', 'ecosystem'];

    var LABELS = {
      export: 'Data Export',
      format: 'Proprietary Formats',
      identity: 'Identity Coupling',
      network: 'Network Effects',
      hardware: 'Hardware Lock-In',
      api: 'API Restrictions',
      pricing: 'Pricing Volatility',
      feature_gating: 'Feature Gating',
      ecosystem: 'Ecosystem Dependency'
    };

    var TOOLTIPS = {
      export: 'How difficult is it to get your data out? Bulk export options, API access, format compatibility.',
      format: 'Does your data stay usable outside this vendor? Proprietary vs open formats.',
      identity: 'SSO dependency, account portability, credential ownership.',
      network: 'How much value comes from other users on the platform?',
      hardware: 'Dependency on vendor-specific hardware or infrastructure.',
      api: 'How proprietary or restrictive are the APIs? Rate limits, breaking changes.',
      pricing: 'History of price increases, pricing transparency, cost predictability.',
      feature_gating: 'Are critical features locked behind higher tiers or add-ons?',
      ecosystem: 'Dependency on the vendor\'s wider ecosystem of tools and integrations.'
    };

    var DEFAULT_WEIGHTS = {
      export: 1.5, format: 1.0, identity: 1.0, network: 0.5,
      hardware: 1.0, api: 1.0, pricing: 0.75, feature_gating: 0.75, ecosystem: 1.0
    };

    var MAX = 5;

    /* ── Scoring functions ── */
    function calculateScore(service) {
      var scores = service.scores;
      var weights = service.weights || DEFAULT_WEIGHTS;
      var totalWeighted = 0;
      var totalMaxWeighted = 0;

      CORE_KEYS.forEach(function(k) {
        var w = weights[k] !== undefined ? weights[k] : DEFAULT_WEIGHTS[k];
        totalWeighted += (scores[k] || 0) * w;
        totalMaxWeighted += MAX * w;
      });

      ADVANCED_KEYS.forEach(function(k) {
        if (scores[k] !== undefined && scores[k] !== null) {
          var w = weights[k] !== undefined ? weights[k] : DEFAULT_WEIGHTS[k];
          totalWeighted += scores[k] * w;
          totalMaxWeighted += MAX * w;
        }
      });

      if (totalMaxWeighted === 0) return 0;
      return Math.round((totalWeighted / totalMaxWeighted) * 100);
    }

    function categoryBreakdown(service) {
      var scores = service.scores;
      var weights = service.weights || DEFAULT_WEIGHTS;
      var result = [];
      var allKeys = CORE_KEYS.concat(ADVANCED_KEYS);

      allKeys.forEach(function(k) {
        if (scores[k] !== undefined && scores[k] !== null) {
          var raw = scores[k];
          var pct = Math.round((raw / MAX) * 100);
          var w = weights[k] !== undefined ? weights[k] : DEFAULT_WEIGHTS[k];
          result.push({ key: k, label: LABELS[k], raw: raw, pct: pct, weight: w });
        }
      });

      return result;
    }

    function dangerLevel(score) {
      if (score <= 20) return 'Safe';
      if (score <= 40) return 'Mild Risk';
      if (score <= 60) return 'Caution';
      if (score <= 80) return 'High Risk';
      return 'Escape Plan Recommended';
    }

    function dangerClass(score) {
      if (score <= 20) return 'safe';
      if (score <= 40) return 'mild';
      if (score <= 60) return 'caution';
      if (score <= 80) return 'high';
      return 'escape';
    }

    /* ── Storage ── */
    var STORAGE_KEY = 'vendor_lockin_services';

    function loadServices() {
      try {
        var data = localStorage.getItem(STORAGE_KEY);
        return data ? JSON.parse(data) : [];
      } catch (e) { return []; }
    }

    function saveServices(services) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(services));
    }

    /* ── State ── */
    var services = loadServices();
    var editingId = null;
    var advancedVisible = false;

    /* ── DOM refs ── */
    var serviceName = document.getElementById('serviceName');
    var serviceCategory = document.getElementById('serviceCategory');
    var serviceNotes = document.getElementById('serviceNotes');
    var saveBtn = document.getElementById('saveBtn');
    var cancelBtn = document.getElementById('cancelBtn');
    var formTitle = document.getElementById('formTitle');
    var formPanel = document.getElementById('formPanel');
    var tablePanel = document.getElementById('tablePanel');
    var detailPanel = document.getElementById('detailPanel');
    var tableArea = document.getElementById('tableArea');
    var emptyState = document.getElementById('emptyState');
    var searchInput = document.getElementById('searchInput');
    var sortSelect = document.getElementById('sortSelect');
    var exportBtn = document.getElementById('exportBtn');
    var importBtn = document.getElementById('importBtn');
    var importFile = document.getElementById('importFile');
    var toggleAdvBtn = document.getElementById('toggleAdvanced');
    var coreContainer = document.getElementById('coreSliders');
    var advContainer = document.getElementById('advancedSliders');

    /* ── Build sliders ── */
    function buildSliders() {
      buildSliderGroup(coreContainer, CORE_KEYS);
      buildSliderGroup(advContainer, ADVANCED_KEYS);
    }

    function buildSliderGroup(container, keys) {
      container.innerHTML = '';
      keys.forEach(function(k) {
        var div = document.createElement('div');
        div.className = 'slider-group';
        div.innerHTML =
          '<div class="slider-label">' +
            '<span>' + LABELS[k] + '</span>' +
            '<span class="tooltip-trigger">?' +
              '<span class="tooltip-text">' + TOOLTIPS[k] + '</span>' +
            '</span>' +
          '</div>' +
          '<div class="slider-wrap">' +
            '<input type="range" min="0" max="5" value="0" data-key="' + k + '">' +
          '</div>' +
          '<span class="slider-value" data-val="' + k + '">0</span>';
        container.appendChild(div);

        var range = div.querySelector('input[type="range"]');
        var valSpan = div.querySelector('.slider-value');
        range.addEventListener('input', function() {
          valSpan.textContent = range.value;
        });
      });
    }

    buildSliders();

    /* ── Toggle advanced ── */
    toggleAdvBtn.addEventListener('click', function() {
      advancedVisible = !advancedVisible;
      advContainer.style.display = advancedVisible ? 'block' : 'none';
      toggleAdvBtn.textContent = advancedVisible ? 'Hide' : 'Show';
    });

    /* ── Collect form scores ── */
    function collectScores() {
      var scores = {};
      CORE_KEYS.forEach(function(k) {
        var el = coreContainer.querySelector('[data-key="' + k + '"]');
        scores[k] = parseInt(el.value, 10);
      });
      if (advancedVisible) {
        ADVANCED_KEYS.forEach(function(k) {
          var el = advContainer.querySelector('[data-key="' + k + '"]');
          scores[k] = parseInt(el.value, 10);
        });
      }
      return scores;
    }

    /* ── Reset form ── */
    function resetForm() {
      serviceName.value = '';
      serviceCategory.value = '';
      serviceNotes.value = '';
      editingId = null;
      formTitle.textContent = 'Add Service';
      saveBtn.textContent = 'Add Service';
      cancelBtn.style.display = 'none';

      // Reset sliders
      coreContainer.querySelectorAll('input[type="range"]').forEach(function(r) {
        r.value = 0;
        var k = r.getAttribute('data-key');
        coreContainer.querySelector('[data-val="' + k + '"]').textContent = '0';
      });
      advContainer.querySelectorAll('input[type="range"]').forEach(function(r) {
        r.value = 0;
        var k = r.getAttribute('data-key');
        advContainer.querySelector('[data-val="' + k + '"]').textContent = '0';
      });

      // Hide advanced
      advancedVisible = false;
      advContainer.style.display = 'none';
      toggleAdvBtn.textContent = 'Show';
    }

    /* ── Populate form for editing ── */
    function populateForm(service) {
      serviceName.value = service.service || '';
      serviceCategory.value = service.category || '';
      serviceNotes.value = service.notes || '';
      editingId = service.id;
      formTitle.textContent = 'Edit Service';
      saveBtn.textContent = 'Save Changes';
      cancelBtn.style.display = '';

      var scores = service.scores || {};

      CORE_KEYS.forEach(function(k) {
        var el = coreContainer.querySelector('[data-key="' + k + '"]');
        el.value = scores[k] || 0;
        coreContainer.querySelector('[data-val="' + k + '"]').textContent = scores[k] || 0;
      });

      // Check if any advanced scores exist
      var hasAdvanced = ADVANCED_KEYS.some(function(k) { return scores[k] !== undefined && scores[k] !== null; });
      if (hasAdvanced) {
        advancedVisible = true;
        advContainer.style.display = 'block';
        toggleAdvBtn.textContent = 'Hide';
      }

      ADVANCED_KEYS.forEach(function(k) {
        var el = advContainer.querySelector('[data-key="' + k + '"]');
        el.value = scores[k] || 0;
        advContainer.querySelector('[data-val="' + k + '"]').textContent = scores[k] || 0;
      });

      formPanel.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    /* ── Save ── */
    saveBtn.addEventListener('click', function() {
      var name = serviceName.value.trim();
      var cat = serviceCategory.value.trim();

      if (!name) {
        serviceName.focus();
        return;
      }
      if (!cat) {
        serviceCategory.focus();
        return;
      }

      var scores = collectScores();
      var now = new Date().toISOString().slice(0, 10);

      if (editingId) {
        // Update
        services = services.map(function(s) {
          if (s.id === editingId) {
            return Object.assign({}, s, {
              service: name,
              category: cat,
              scores: scores,
              notes: serviceNotes.value.trim(),
              last_reviewed: now
            });
          }
          return s;
        });
      } else {
        // Add new
        services.push({
          id: Date.now().toString(36) + Math.random().toString(36).slice(2, 7),
          service: name,
          category: cat,
          scores: scores,
          weights: Object.assign({}, DEFAULT_WEIGHTS),
          notes: serviceNotes.value.trim(),
          last_reviewed: now
        });
      }

      saveServices(services);
      resetForm();
      renderTable();
    });

    /* ── Cancel ── */
    cancelBtn.addEventListener('click', function() {
      resetForm();
    });

    /* ── Render table ── */
    function renderTable() {
      var query = searchInput.value.toLowerCase().trim();
      var sortBy = sortSelect.value;

      // Filter
      var filtered = services.filter(function(s) {
        if (!query) return true;
        return s.service.toLowerCase().includes(query) ||
               s.category.toLowerCase().includes(query) ||
               (s.notes || '').toLowerCase().includes(query);
      });

      // Sort
      filtered.sort(function(a, b) {
        if (sortBy === 'score') return calculateScore(b) - calculateScore(a);
        if (sortBy === 'name') return a.service.localeCompare(b.service);
        if (sortBy === 'category') return a.category.localeCompare(b.category);
        if (sortBy === 'date') return (b.last_reviewed || '').localeCompare(a.last_reviewed || '');
        return 0;
      });

      if (services.length === 0) {
        tableArea.innerHTML = '';
        tableArea.appendChild(emptyState);
        emptyState.style.display = 'block';
        return;
      }

      if (filtered.length === 0) {
        tableArea.innerHTML = '<div class="empty-state">No services match &ldquo;' + escapeHtml(query) + '&rdquo;</div>';
        return;
      }

      var html = '<table class="services-table"><thead><tr>' +
        '<th>Service</th><th class="hide-mobile">Category</th><th>Risk</th><th class="hide-mobile">Reviewed</th><th></th>' +
        '</tr></thead><tbody>';

      filtered.forEach(function(s) {
        var score = calculateScore(s);
        var cls = dangerClass(score);
        var level = dangerLevel(score);
        html += '<tr>' +
          '<td><a href="#" class="svc-link" data-id="' + s.id + '" style="color:var(--primary);text-decoration:none;">' + escapeHtml(s.service) + '</a></td>' +
          '<td class="hide-mobile">' + escapeHtml(s.category) + '</td>' +
          '<td><span class="score-badge score-badge--' + cls + '">' + score + ' &middot; ' + level + '</span></td>' +
          '<td class="hide-mobile">' + (s.last_reviewed || '&mdash;') + '</td>' +
          '<td>' +
            '<button class="btn btn-secondary btn-sm edit-btn" data-id="' + s.id + '">Edit</button> ' +
            '<button class="btn btn-danger btn-sm del-btn" data-id="' + s.id + '">Del</button>' +
          '</td>' +
          '</tr>';
      });

      html += '</tbody></table>';
      tableArea.innerHTML = html;

      // Bind events
      tableArea.querySelectorAll('.svc-link').forEach(function(a) {
        a.addEventListener('click', function(e) {
          e.preventDefault();
          showDetail(a.getAttribute('data-id'));
        });
      });
      tableArea.querySelectorAll('.edit-btn').forEach(function(btn) {
        btn.addEventListener('click', function() {
          var svc = services.find(function(s) { return s.id === btn.getAttribute('data-id'); });
          if (svc) populateForm(svc);
        });
      });
      tableArea.querySelectorAll('.del-btn').forEach(function(btn) {
        btn.addEventListener('click', function() {
          if (confirm('Delete this service?')) {
            var id = btn.getAttribute('data-id');
            services = services.filter(function(s) { return s.id !== id; });
            saveServices(services);
            renderTable();
          }
        });
      });
    }

    searchInput.addEventListener('input', renderTable);
    sortSelect.addEventListener('change', renderTable);

    /* ── Detail view ── */
    function showDetail(id) {
      var svc = services.find(function(s) { return s.id === id; });
      if (!svc) return;

      detailPanel.style.display = 'block';
      tablePanel.style.display = 'none';
      formPanel.style.display = 'none';

      document.getElementById('detailTitle').textContent = svc.service;
      document.getElementById('detailMeta').innerHTML =
        '<span>Category: ' + escapeHtml(svc.category) + '</span>' +
        '<span>Last reviewed: ' + (svc.last_reviewed || 'N/A') + '</span>';

      var score = calculateScore(svc);
      var cls = dangerClass(score);
      var level = dangerLevel(score);

      document.getElementById('detailScore').innerHTML =
        '<div style="text-align:center;margin-bottom:1.5rem;">' +
          '<span class="score-badge score-badge--' + cls + '" style="font-size:1.25rem;padding:0.5rem 1.25rem;">' +
            score + ' / 100 &middot; ' + level +
          '</span>' +
        '</div>';

      var bd = categoryBreakdown(svc);
      var bdHtml = '<div class="breakdown-grid">';
      bd.forEach(function(item) {
        var c = dangerClass(item.pct);
        bdHtml += '<div class="breakdown-item">' +
          '<div class="breakdown-label">' + item.label + ' (w:' + item.weight + ')</div>' +
          '<div class="breakdown-bar"><div class="breakdown-fill ' + c + '" style="width:' + item.pct + '%"></div></div>' +
          '<div class="breakdown-value">' + item.raw + '/' + MAX + ' (' + item.pct + '%)</div>' +
          '</div>';
      });
      bdHtml += '</div>';
      document.getElementById('detailBreakdown').innerHTML = bdHtml;

      if (svc.notes) {
        document.getElementById('detailNotes').innerHTML =
          '<div class="notes-display">' + escapeHtml(svc.notes) + '</div>';
      } else {
        document.getElementById('detailNotes').innerHTML = '';
      }

      // Bind detail buttons
      document.getElementById('detailEdit').onclick = function() {
        hideDetail();
        populateForm(svc);
      };
      document.getElementById('detailDelete').onclick = function() {
        if (confirm('Delete ' + svc.service + '?')) {
          services = services.filter(function(s) { return s.id !== id; });
          saveServices(services);
          hideDetail();
          renderTable();
        }
      };

      detailPanel.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function hideDetail() {
      detailPanel.style.display = 'none';
      tablePanel.style.display = '';
      formPanel.style.display = '';
    }

    document.getElementById('detailBack').addEventListener('click', hideDetail);

    /* ── Export / Import ── */
    exportBtn.addEventListener('click', function() {
      if (services.length === 0) return;
      var blob = new Blob([JSON.stringify(services, null, 2)], { type: 'application/json' });
      var url = URL.createObjectURL(blob);
      var a = document.createElement('a');
      a.href = url;
      a.download = 'vendor-lock-in-scores.json';
      a.click();
      URL.revokeObjectURL(url);
    });

    importBtn.addEventListener('click', function() {
      importFile.click();
    });

    importFile.addEventListener('change', function() {
      var file = importFile.files[0];
      if (!file) return;

      var reader = new FileReader();
      reader.onload = function(e) {
        try {
          var imported = JSON.parse(e.target.result);
          if (!Array.isArray(imported)) throw new Error('Invalid format');

          // Validate and merge
          var valid = imported.filter(function(s) {
            return s && s.id && s.service && s.category && s.scores;
          });

          if (valid.length === 0) {
            alert('No valid services found in file.');
            return;
          }

          // Merge: imported overwrite existing with same id, new ones appended
          var map = {};
          services.forEach(function(s) { map[s.id] = s; });
          valid.forEach(function(s) { map[s.id] = s; });
          services = Object.keys(map).map(function(k) { return map[k]; });

          saveServices(services);
          renderTable();
          alert('Imported ' + valid.length + ' service(s).');
        } catch (err) {
          alert('Error importing file: ' + err.message);
        }
      };
      reader.readAsText(file);
      importFile.value = '';
    });

    /* ── Helpers ── */
    function escapeHtml(str) {
      var div = document.createElement('div');
      div.appendChild(document.createTextNode(str));
      return div.innerHTML;
    }

    /* ── Init ── */
    renderTable();
  })();
  </script>
</body>
</html>
