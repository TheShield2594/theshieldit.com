<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Cracking Simulator | The Shield IT</title>
    <meta name="description" content="See how long it would take to crack your password using dictionary attacks, brute force, and GPU cracking. Educational simulator ‚Äî no passwords are sent anywhere.">
    <link rel="icon" href="/favicon.ico">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: #e2e8f0; min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 30px; padding-top: 20px; }
        h1 { font-size: 2.4rem; margin-bottom: 8px; background: linear-gradient(135deg, #ef4444 0%, #8b5cf6 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .subtitle { color: #94a3b8; font-size: 1rem; }
        .back-link { display: inline-flex; align-items: center; gap: 8px; color: #64748b; text-decoration: none; font-size: 0.9rem; margin-bottom: 24px; }
        .back-link:hover { color: #94a3b8; }
        .card { background: rgba(30,41,59,0.8); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 28px; margin-bottom: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); }
        .privacy-note { background: rgba(34,197,94,0.08); border: 1px solid rgba(34,197,94,0.2); border-radius: 10px; padding: 12px 16px; font-size: 0.82rem; color: #86efac; margin-bottom: 20px; }
        .input-group { position: relative; margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-size: 0.9rem; color: #cbd5e1; font-weight: 500; }
        .pw-input-wrap { position: relative; }
        input[type="text"], input[type="password"] { width: 100%; padding: 14px 50px 14px 18px; background: rgba(15,23,42,0.6); border: 2px solid rgba(255,255,255,0.1); border-radius: 12px; color: #e2e8f0; font-size: 1rem; font-family: 'Courier New', monospace; transition: border-color 0.3s; }
        input:focus { outline: none; border-color: rgba(239,68,68,0.5); }
        .toggle-vis { position: absolute; right: 14px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #64748b; cursor: pointer; font-size: 1.1rem; }
        .strength-bar-bg { height: 8px; background: rgba(255,255,255,0.08); border-radius: 999px; overflow: hidden; margin: 10px 0 6px; }
        .strength-bar-fill { height: 100%; border-radius: 999px; transition: width 0.4s, background 0.4s; }
        .strength-label { font-size: 0.8rem; font-weight: 600; }
        .char-analysis { display: flex; gap: 10px; flex-wrap: wrap; margin: 12px 0; }
        .char-chip { padding: 4px 12px; border-radius: 20px; font-size: 0.78rem; font-weight: 600; }
        .chip-yes { background: rgba(34,197,94,0.15); color: #86efac; border: 1px solid rgba(34,197,94,0.2); }
        .chip-no { background: rgba(100,116,139,0.15); color: #64748b; border: 1px solid rgba(100,116,139,0.2); }
        .attack-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 14px; }
        .attack-card { background: rgba(15,23,42,0.6); border-radius: 12px; padding: 18px; border-left: 4px solid; }
        .attack-card.instant { border-color: #ef4444; }
        .attack-card.fast { border-color: #f97316; }
        .attack-card.medium { border-color: #f59e0b; }
        .attack-card.slow { border-color: #22c55e; }
        .attack-card.verylong { border-color: #3b82f6; }
        .attack-name { font-size: 0.85rem; font-weight: 700; color: #f1f5f9; margin-bottom: 6px; }
        .attack-desc { font-size: 0.75rem; color: #64748b; margin-bottom: 10px; line-height: 1.5; }
        .attack-time { font-size: 1.2rem; font-weight: 800; margin-bottom: 4px; }
        .attack-detail { font-size: 0.72rem; color: #64748b; }
        .entropy-box { background: rgba(15,23,42,0.5); border-radius: 12px; padding: 18px; display: flex; flex-wrap: wrap; gap: 20px; }
        .entropy-stat { flex: 1; min-width: 120px; text-align: center; }
        .entropy-val { font-size: 2rem; font-weight: 800; color: #8b5cf6; }
        .entropy-label { font-size: 0.72rem; color: #64748b; margin-top: 4px; }
        .tips { display: flex; flex-direction: column; gap: 10px; }
        .tip-item { display: flex; gap: 12px; align-items: flex-start; padding: 12px; background: rgba(15,23,42,0.4); border-radius: 10px; font-size: 0.85rem; }
        .tip-icon { font-size: 1.1rem; flex-shrink: 0; }
        .tip-text { color: #94a3b8; line-height: 1.6; }
        .examples-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 10px; margin-top: 16px; }
        .example-item { background: rgba(15,23,42,0.5); border-radius: 10px; padding: 12px 16px; cursor: pointer; border: 1px solid rgba(255,255,255,0.06); transition: border-color 0.2s; }
        .example-item:hover { border-color: rgba(239,68,68,0.3); }
        .example-pw { font-family: monospace; font-size: 0.85rem; color: #e2e8f0; margin-bottom: 4px; }
        .example-label { font-size: 0.72rem; color: #64748b; }
    </style>
  <script src="/shared-shell.js" defer></script>
</head>
<body>
<div class="container">
    <a href="/" class="back-link">‚Üê Back to Tools</a>
    <header>
        <h1>Password Cracking Simulator</h1>
        <p class="subtitle">See how long it takes to crack passwords ‚Äî educational simulation, nothing is sent to any server</p>
    </header>

    <div class="card">
        <div class="privacy-note">üîí All analysis is done entirely in your browser. Your password never leaves your device.</div>
        <div class="input-group">
            <label for="pwInput">Enter a password to analyze</label>
            <div class="pw-input-wrap">
                <input type="password" id="pwInput" placeholder="Type or paste a password..." oninput="analyze(this.value)" autocomplete="off" spellcheck="false">
                <button class="toggle-vis" onclick="toggleVis()" title="Show/hide">üëÅÔ∏è</button>
            </div>
        </div>
        <div class="strength-bar-bg"><div class="strength-bar-fill" id="strengthBar" style="width:0%"></div></div>
        <div class="strength-label" id="strengthLabel">Start typing to analyze</div>
        <div class="char-analysis" id="charAnalysis"></div>
    </div>

    <div class="card">
        <h2 style="font-size:1.2rem; margin-bottom:16px;">Entropy Analysis</h2>
        <div class="entropy-box" id="entropyBox">
            <div class="entropy-stat"><div class="entropy-val" id="entBits">0</div><div class="entropy-label">Bits of Entropy</div></div>
            <div class="entropy-stat"><div class="entropy-val" id="entCharset">0</div><div class="entropy-label">Charset Size</div></div>
            <div class="entropy-stat"><div class="entropy-val" id="entLength">0</div><div class="entropy-label">Password Length</div></div>
            <div class="entropy-stat"><div class="entropy-val" id="entCombinations">‚Äî</div><div class="entropy-label">Possible Combinations</div></div>
        </div>
    </div>

    <div class="card">
        <h2 style="font-size:1.2rem; margin-bottom:16px;">Estimated Crack Time by Attack Method</h2>
        <div class="attack-grid" id="attackGrid">
            <div style="color:#64748b; font-size:0.9rem; grid-column:1/-1;">Enter a password above to see crack time estimates.</div>
        </div>
    </div>

    <div class="card">
        <h2 style="font-size:1.2rem; margin-bottom:16px;">Try These Examples</h2>
        <div class="examples-grid" id="examplesGrid"></div>
    </div>

    <div class="card">
        <h2 style="font-size:1.2rem; margin-bottom:16px;">How to Create Strong Passwords</h2>
        <div class="tips">
            <div class="tip-item"><div class="tip-icon">üìè</div><div class="tip-text"><strong>Length is king.</strong> Each additional character exponentially increases crack time. A random 20-character password is astronomically stronger than a complex 8-character one.</div></div>
            <div class="tip-item"><div class="tip-icon">üé≤</div><div class="tip-text"><strong>Use a passphrase.</strong> 4-5 random words (e.g. "purple-lamp-tiger-ocean-42") are easy to remember and extremely hard to crack. Check our Password Generator for secure passphrases.</div></div>
            <div class="tip-item"><div class="tip-icon">üî§</div><div class="tip-text"><strong>Maximize charset.</strong> Using all 4 character types (uppercase, lowercase, numbers, symbols) increases the possible combinations per character position from 26 to 95.</div></div>
            <div class="tip-item"><div class="tip-icon">‚ùå</div><div class="tip-text"><strong>Avoid predictable patterns.</strong> "P@ssw0rd", "S3cur3!", "Password1!" and leet-speak substitutions are in every dictionary attack list. They offer minimal security despite appearing complex.</div></div>
            <div class="tip-item"><div class="tip-icon">üîë</div><div class="tip-text"><strong>Use a password manager.</strong> You only need one strong master password. The manager generates and remembers unique, random passwords for every site. Bitwarden is free and open-source.</div></div>
            <div class="tip-item"><div class="tip-icon">üõ°Ô∏è</div><div class="tip-text"><strong>Enable MFA.</strong> Even a weak password becomes much harder to exploit with multi-factor authentication. An attacker with your cracked password still can't log in without your second factor.</div></div>
        </div>
    </div>
</div>

<script>
const EXAMPLES = [
    { pw: '123456', label: 'Most common password' },
    { pw: 'P@ssw0rd1', label: 'Typical "complex" policy' },
    { pw: 'MyDog2019!', label: 'Personal info + year' },
    { pw: 'correct-horse-battery', label: '3-word passphrase' },
    { pw: 'X7$kP#mQ2@vL', label: '12-char random' },
    { pw: 'Tr0ub4dor&3', label: 'XKCD-style weak' },
    { pw: 'purple-lamp-tiger-ocean-42', label: '5-word passphrase' },
    { pw: 'j5!Kv@2mPq#XnW8&', label: '16-char fully random' },
];

const ATTACK_SPEEDS = {
    dict:     { name: 'Dictionary Attack', speed: 1e9, unit: 'GPU', desc: 'Tests common passwords, words, and variations from lists of billions of known passwords. Cracks most real-world passwords almost instantly.' },
    gpu4:     { name: 'GPU Cluster (RTX 4090)', speed: 2.5e10, unit: 'SHA-256', desc: '1√ó RTX 4090 doing raw SHA-256 brute force (~25B hashes/sec). Represents a single high-end gaming GPU available for ~$1,800.' },
    bcrypt:   { name: 'Bcrypt (cost 12)', speed: 2e4, unit: 'hashes/sec', desc: 'Purposely slow hash function recommended for passwords. Dramatically limits cracking speed regardless of hardware.' },
    argon2:   { name: 'Argon2id', speed: 2e3, unit: 'hashes/sec', desc: 'Memory-hard function ‚Äî best-in-class for password storage. GPU advantage nearly eliminated. Requires hundreds of MB per guess.' },
    md5:      { name: 'MD5 (legacy)', speed: 3e11, unit: 'hashes/sec', desc: 'Completely broken for passwords. Legacy systems still using MD5 can be cracked at 300 billion hashes/second with a GPU cluster.' },
    rainbow:  { name: 'Rainbow Table', speed: 5e12, unit: 'lookups/sec', desc: 'Precomputed lookup table covering all common short passwords. Instant if your hash is unsalted. Salting defeats rainbow tables.' },
};

let showPw = false;
function toggleVis() {
    const inp = document.getElementById('pwInput');
    showPw = !showPw;
    inp.type = showPw ? 'text' : 'password';
}

function charsetSize(pw) {
    let size = 0;
    if (/[a-z]/.test(pw)) size += 26;
    if (/[A-Z]/.test(pw)) size += 26;
    if (/[0-9]/.test(pw)) size += 10;
    if (/[^a-zA-Z0-9]/.test(pw)) size += 33;
    return Math.max(size, 1);
}

function formatTime(seconds) {
    if (seconds < 1e-3) return 'Instantly';
    if (seconds < 60) return seconds.toFixed(1) + ' seconds';
    if (seconds < 3600) return (seconds/60).toFixed(1) + ' minutes';
    if (seconds < 86400) return (seconds/3600).toFixed(1) + ' hours';
    if (seconds < 86400*365) return (seconds/86400).toFixed(0) + ' days';
    if (seconds < 86400*365*1000) return (seconds/(86400*365)).toFixed(0) + ' years';
    if (seconds < 86400*365*1e6) return (seconds/(86400*365*1000)).toFixed(0) + ' thousand years';
    if (seconds < 86400*365*1e9) return (seconds/(86400*365*1e6)).toFixed(0) + ' million years';
    if (seconds < 86400*365*1e12) return (seconds/(86400*365*1e9)).toFixed(0) + ' billion years';
    return '‚àû (heat death of universe)';
}

function timeClass(seconds) {
    if (seconds < 1) return 'instant';
    if (seconds < 3600) return 'fast';
    if (seconds < 86400*30) return 'medium';
    if (seconds < 86400*365*10) return 'slow';
    return 'verylong';
}

function formatBig(n) {
    if (n < 1e6) return n.toFixed(0);
    if (n < 1e9) return (n/1e6).toFixed(1) + 'M';
    if (n < 1e12) return (n/1e9).toFixed(1) + 'B';
    if (n < 1e15) return (n/1e12).toFixed(1) + 'T';
    if (n < 1e18) return (n/1e15).toFixed(1) + 'Q';
    return '10^' + Math.round(Math.log10(n));
}

function isDictionary(pw) {
    const common = ['password','123456','qwerty','abc123','letmein','monkey','dragon','master','welcome','login','admin','iloveyou','sunshine','princess','football','shadow','superman','batman','hello','test'];
    const lc = pw.toLowerCase().replace(/[^a-z]/g, '');
    return common.some(w => lc === w || lc.includes(w));
}

function analyze(pw) {
    const len = pw.length;
    const cs = charsetSize(pw);
    const combinations = Math.pow(cs, len);
    const entropy = len * Math.log2(cs);

    // Update char analysis chips
    const chips = [
        { label: 'Lowercase', has: /[a-z]/.test(pw) },
        { label: 'Uppercase', has: /[A-Z]/.test(pw) },
        { label: 'Numbers', has: /[0-9]/.test(pw) },
        { label: 'Symbols', has: /[^a-zA-Z0-9]/.test(pw) },
        { label: '16+ chars', has: len >= 16 },
        { label: 'In dictionary', has: len > 0 && isDictionary(pw) },
    ];
    document.getElementById('charAnalysis').innerHTML = chips.map(c =>
        `<span class="char-chip ${c.has ? 'chip-yes' : 'chip-no'}">${c.has ? '‚úì' : '‚úó'} ${c.label}</span>`
    ).join('');

    // Strength bar
    let strength = 0;
    if (len >= 8) strength += 15;
    if (len >= 12) strength += 15;
    if (len >= 16) strength += 20;
    if (len >= 20) strength += 10;
    if (/[A-Z]/.test(pw)) strength += 10;
    if (/[0-9]/.test(pw)) strength += 10;
    if (/[^a-zA-Z0-9]/.test(pw)) strength += 15;
    if (!isDictionary(pw)) strength += 5;
    strength = Math.min(100, Math.max(0, strength));

    const bar = document.getElementById('strengthBar');
    bar.style.width = strength + '%';
    let color, label;
    if (strength < 25) { color = '#ef4444'; label = 'Very Weak'; }
    else if (strength < 45) { color = '#f97316'; label = 'Weak'; }
    else if (strength < 65) { color = '#f59e0b'; label = 'Moderate'; }
    else if (strength < 80) { color = '#84cc16'; label = 'Strong'; }
    else { color = '#22c55e'; label = 'Very Strong'; }
    bar.style.background = color;
    document.getElementById('strengthLabel').textContent = pw ? `${label} (${strength}/100)` : 'Start typing to analyze';
    document.getElementById('strengthLabel').style.color = pw ? color : '#64748b';

    // Entropy
    document.getElementById('entBits').textContent = entropy.toFixed(1);
    document.getElementById('entCharset').textContent = cs;
    document.getElementById('entLength').textContent = len;
    document.getElementById('entCombinations').textContent = len > 0 ? formatBig(combinations) : '‚Äî';

    // Attacks
    if (!pw) {
        document.getElementById('attackGrid').innerHTML = '<div style="color:#64748b; font-size:0.9rem; grid-column:1/-1;">Enter a password above to see crack time estimates.</div>';
        return;
    }

    const dictMatch = isDictionary(pw);
    const grid = document.getElementById('attackGrid');
    grid.innerHTML = '';

    for (const [key, atk] of Object.entries(ATTACK_SPEEDS)) {
        let seconds;
        if (key === 'dict') {
            // Dictionary: if it's in a common list, instant; else estimate with variations
            seconds = dictMatch ? 0.001 : combinations / 1e9;
        } else if (key === 'rainbow') {
            // Rainbow: only effective for short/unsalted hashes
            seconds = len <= 10 ? 0.001 : combinations / atk.speed;
        } else {
            seconds = combinations / atk.speed;
        }

        const cls = timeClass(seconds);
        const div = document.createElement('div');
        div.className = `attack-card ${cls}`;
        div.innerHTML = `
            <div class="attack-name">${atk.name}</div>
            <div class="attack-desc">${atk.desc}</div>
            <div class="attack-time" style="color:${cls==='instant'?'#ef4444':cls==='fast'?'#f97316':cls==='medium'?'#f59e0b':cls==='slow'?'#84cc16':'#22c55e'}">${formatTime(seconds)}</div>
            <div class="attack-detail">${formatBig(atk.speed)} ${atk.unit}/sec</div>
        `;
        grid.appendChild(div);
    }
}

// Render examples
const eg = document.getElementById('examplesGrid');
for (const ex of EXAMPLES) {
    const div = document.createElement('div');
    div.className = 'example-item';
    div.onclick = () => {
        const inp = document.getElementById('pwInput');
        inp.value = ex.pw;
        inp.type = 'text';
        showPw = true;
        analyze(ex.pw);
    };
    div.innerHTML = `<div class="example-pw">${ex.pw}</div><div class="example-label">${ex.label}</div>`;
    eg.appendChild(div);
}
</script>
</body>
</html>
